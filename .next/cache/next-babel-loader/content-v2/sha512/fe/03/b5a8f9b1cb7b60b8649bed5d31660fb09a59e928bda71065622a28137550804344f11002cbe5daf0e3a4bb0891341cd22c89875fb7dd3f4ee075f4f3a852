{"ast":null,"code":"import _regeneratorRuntime from \"/Users/neilhacker/Desktop/project/working_on/ostrom_id_copy_7/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/neilhacker/Desktop/project/working_on/ostrom_id_copy_7/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nexport function calculateProof(_x, _x2) {\n  return _calculateProof.apply(this, arguments);\n}\n\nfunction _calculateProof() {\n  _calculateProof = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(preImage, hash) {\n    var _yield$snarkjs$groth, proof, publicSignals, solidityProof;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return snarkjs.groth16.fullProve({\n              x: preImage,\n              hash: hash.toString()\n            }, \"/circuits/hash/circuit.wasm\", \"/circuits/hash/circuit_final.zkey\");\n\n          case 2:\n            _yield$snarkjs$groth = _context.sent;\n            proof = _yield$snarkjs$groth.proof;\n            publicSignals = _yield$snarkjs$groth.publicSignals;\n            _context.next = 7;\n            return groth16ExportSolidityCallData(proof, publicSignals);\n\n          case 7:\n            solidityProof = _context.sent;\n            return _context.abrupt(\"return\", solidityProof);\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _calculateProof.apply(this, arguments);\n}\n\nfunction p256(n) {\n  var nstr = BigInt(n).toString(16);\n\n  while (nstr.length < 64) {\n    nstr = \"0\" + nstr;\n  }\n\n  nstr = \"\\\"0x\".concat(nstr, \"\\\"\");\n  return nstr;\n}\n\nfunction groth16ExportSolidityCallData(_x3, _x4) {\n  return _groth16ExportSolidityCallData.apply(this, arguments);\n}\n\nfunction _groth16ExportSolidityCallData() {\n  _groth16ExportSolidityCallData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(proof, pub) {\n    var inputs, i, S;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            inputs = \"\";\n\n            for (i = 0; i < pub.length; i++) {\n              if (inputs != \"\") inputs = inputs + \",\";\n              inputs = inputs + p256(pub[i]);\n            }\n\n            S = \"[\".concat(p256(proof.pi_a[0]), \", \").concat(p256(proof.pi_a[1]), \"],\") + \"[[\".concat(p256(proof.pi_b[0][1]), \", \").concat(p256(proof.pi_b[0][0]), \"],[\").concat(p256(proof.pi_b[1][1]), \", \").concat(p256(proof.pi_b[1][0]), \"]],\") + \"[\".concat(p256(proof.pi_c[0]), \", \").concat(p256(proof.pi_c[1]), \"],\") + \"[\".concat(inputs, \"]\");\n            return _context2.abrupt(\"return\", S);\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _groth16ExportSolidityCallData.apply(this, arguments);\n}","map":{"version":3,"sources":["/Users/neilhacker/Desktop/project/working_on/ostrom_id_copy_7/public/prover.js"],"names":["calculateProof","preImage","hash","snarkjs","groth16","fullProve","x","toString","proof","publicSignals","groth16ExportSolidityCallData","solidityProof","p256","n","nstr","BigInt","length","pub","inputs","i","S","pi_a","pi_b","pi_c"],"mappings":";;AAAA,gBAAsBA,cAAtB;AAAA;AAAA;;;6EAAO,iBAA8BC,QAA9B,EAAwCC,IAAxC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEKC,OAAO,CAACC,OAAR,CAAgBC,SAAhB,CAA0B;AAAEC,cAAAA,CAAC,EAAEL,QAAL;AAAeC,cAAAA,IAAI,EAAEA,IAAI,CAACK,QAAL;AAArB,aAA1B,EAAkE,6BAAlE,EAAiG,mCAAjG,CAFL;;AAAA;AAAA;AACKC,YAAAA,KADL,wBACKA,KADL;AACYC,YAAAA,aADZ,wBACYA,aADZ;AAAA;AAAA,mBAIyBC,6BAA6B,CAACF,KAAD,EAAQC,aAAR,CAJtD;;AAAA;AAIGE,YAAAA,aAJH;AAAA,6CAMIA,aANJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AASL,SAASC,IAAT,CAAcC,CAAd,EAAiB;AACf,MAAIC,IAAI,GAAGC,MAAM,CAACF,CAAD,CAAN,CAAUN,QAAV,CAAmB,EAAnB,CAAX;;AACA,SAAOO,IAAI,CAACE,MAAL,GAAc,EAArB;AAAyBF,IAAAA,IAAI,GAAG,MAAIA,IAAX;AAAzB;;AACAA,EAAAA,IAAI,iBAASA,IAAT,OAAJ;AAEA,SAAOA,IAAP;AACH;;SAEcJ,6B;;;;;4FAAf,kBAA6CF,KAA7C,EAAoDS,GAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAEQC,YAAAA,MAFR,GAEiB,EAFjB;;AAGI,iBAASC,CAAT,GAAW,CAAX,EAAcA,CAAC,GAACF,GAAG,CAACD,MAApB,EAA4BG,CAAC,EAA7B,EAAiC;AAC7B,kBAAID,MAAM,IAAI,EAAd,EAAkBA,MAAM,GAAGA,MAAM,GAAG,GAAlB;AAClBA,cAAAA,MAAM,GAAGA,MAAM,GAAGN,IAAI,CAACK,GAAG,CAACE,CAAD,CAAJ,CAAtB;AACH;;AAGDC,YAAAA,CAAC,GAAC,WAAIR,IAAI,CAACJ,KAAK,CAACa,IAAN,CAAW,CAAX,CAAD,CAAR,eAA4BT,IAAI,CAACJ,KAAK,CAACa,IAAN,CAAW,CAAX,CAAD,CAAhC,sBACOT,IAAI,CAACJ,KAAK,CAACc,IAAN,CAAW,CAAX,EAAc,CAAd,CAAD,CADX,eACkCV,IAAI,CAACJ,KAAK,CAACc,IAAN,CAAW,CAAX,EAAc,CAAd,CAAD,CADtC,gBAC8DV,IAAI,CAACJ,KAAK,CAACc,IAAN,CAAW,CAAX,EAAc,CAAd,CAAD,CADlE,eACyFV,IAAI,CAACJ,KAAK,CAACc,IAAN,CAAW,CAAX,EAAc,CAAd,CAAD,CAD7F,sBAEMV,IAAI,CAACJ,KAAK,CAACe,IAAN,CAAW,CAAX,CAAD,CAFV,eAE8BX,IAAI,CAACJ,KAAK,CAACe,IAAN,CAAW,CAAX,CAAD,CAFlC,qBAGML,MAHN,MAAF;AATJ,8CAcWE,CAdX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["export async function calculateProof(preImage, hash) {\n    const { proof, publicSignals } =\n      await snarkjs.groth16.fullProve({ x: preImage, hash: hash.toString() }, \"/circuits/hash/circuit.wasm\", \"/circuits/hash/circuit_final.zkey\");\n\n    const solidityProof = await groth16ExportSolidityCallData(proof, publicSignals)\n  \n    return solidityProof;\n}\n\n  function p256(n) {\n    let nstr = BigInt(n).toString(16);\n    while (nstr.length < 64) nstr = \"0\"+nstr;\n    nstr = `\"0x${nstr}\"`;\n\n    return nstr;\n}\n\nasync function groth16ExportSolidityCallData(proof, pub) {\n\n    let inputs = \"\";\n    for (let i=0; i<pub.length; i++) {\n        if (inputs != \"\") inputs = inputs + \",\";\n        inputs = inputs + p256(pub[i]);\n    }\n\n    let S;\n    S=`[${p256(proof.pi_a[0])}, ${p256(proof.pi_a[1])}],` +\n        `[[${p256(proof.pi_b[0][1])}, ${p256(proof.pi_b[0][0])}],[${p256(proof.pi_b[1][1])}, ${p256(proof.pi_b[1][0])}]],` +\n        `[${p256(proof.pi_c[0])}, ${p256(proof.pi_c[1])}],` +\n        `[${inputs}]`;\n\n    return S;\n}\n"]},"metadata":{},"sourceType":"module"}